parameters:
    joomla.class: XTAIN\Bundle\JoomlaBundle\Joomla\Joomla
    joomla.helper.class: XTAIN\Bundle\JoomlaBundle\Joomla\JoomlaHelper
    joomla.controller.class: XTAIN\Bundle\JoomlaBundle\Controller\JoomlaController
    joomla.warmer.patcher.class: XTAIN\Bundle\JoomlaBundle\CacheWarmer\JoomlaMonkeyPatchWarmer
    joomla.locale_listener.class: XTAIN\Bundle\JoomlaBundle\Joomla\JoomlaLocaleListener
    joomla.request_listener.class: XTAIN\Bundle\JoomlaBundle\Joomla\JoomlaRequestListener
    joomla.response_listener.class: XTAIN\Bundle\JoomlaBundle\Joomla\JoomlaResponseListener
    joomla.twig.module.class: XTAIN\Bundle\JoomlaBundle\Twig\ModuleExtension
    joomla.logger_proxy.class: XTAIN\Bundle\JoomlaBundle\Joomla\LoggerProxy

    joomla.factory.debug.error_handler.class: XTAIN\Bundle\JoomlaBundle\Factory\Debug\ErrorHandlerFactory
    joomla.factory.loader.class: XTAIN\Bundle\JoomlaBundle\Factory\LoaderFactory
    joomla.factory.config.class: XTAIN\Bundle\JoomlaBundle\Factory\ConfigFactory
    joomla.factory.factory.class: XTAIN\Bundle\JoomlaBundle\Factory\Joomla\FactoryFactory
    joomla.factory.uri.class: XTAIN\Bundle\JoomlaBundle\Factory\Joomla\Uri\UriFactory
    joomla.factory.event.dispatcher.class: XTAIN\Bundle\JoomlaBundle\Factory\Joomla\Event\DispatcherFactory
    joomla.factory.log.class: XTAIN\Bundle\JoomlaBundle\Factory\Joomla\Log\LogFactory
    joomla.factory.profiler.class: XTAIN\Bundle\JoomlaBundle\Factory\Joomla\Profiler\ProfilerFactory
    joomla.factory.session.class: XTAIN\Bundle\JoomlaBundle\Factory\Joomla\Session\SessionFactory
    joomla.factory.cms.module.helper.class: XTAIN\Bundle\JoomlaBundle\Factory\CMS\Module\HelperFactory
    joomla.factory.cms.router.site.class: XTAIN\Bundle\JoomlaBundle\Factory\CMS\Router\SiteFactory
    joomla.factory.application.base.class: XTAIN\Bundle\JoomlaBundle\Factory\Joomla\Application\BaseFactory
    joomla.factory.application.web.class: XTAIN\Bundle\JoomlaBundle\Factory\Joomla\Application\WebFactory
    joomla.factory.cms.application.site.class: XTAIN\Bundle\JoomlaBundle\Factory\CMS\Application\SiteFactory
    joomla.factory.cms.application.administrator.class: XTAIN\Bundle\JoomlaBundle\Factory\CMS\Application\AdministratorFactory
    joomla.factory.view.legacy.class: XTAIN\Bundle\JoomlaBundle\Factory\View\LegacyFactory
    joomla.factory.document.html.class: XTAIN\Bundle\JoomlaBundle\Factory\Joomla\Document\HtmlFactory
    joomla.factory.legacy.error.class: XTAIN\Bundle\JoomlaBundle\Factory\Legacy\Error\ErrorFactory
    joomla.factory.database.driver.doctrine.class: XTAIN\Bundle\JoomlaBundle\Factory\Joomla\Database\Driver\DoctrineDriverFactory
    joomla.factory.user.class: XTAIN\Bundle\JoomlaBundle\Factory\Joomla\User\UserFactory
    joomla.factory.mail.class: XTAIN\Bundle\JoomlaBundle\Factory\Joomla\Mail\MailFactory
    joomla.factory.component.symfony.field.route.class: XTAIN\Bundle\JoomlaBundle\Component\Symfony\Field\RouteFactory
    joomla.factory.component.symfony.field.symfony_modules.class: XTAIN\Bundle\JoomlaBundle\Component\Symfony\Field\SymfonyModules
    joomla.factory.component.symfony.field.symfony_settings.class: XTAIN\Bundle\JoomlaBundle\Component\Symfony\Field\SymfonySettings
    joomla.factory.component.symfony.view.symfony.class: XTAIN\Bundle\JoomlaBundle\Component\Symfony\View\SymfonyFactory
    joomla.factory.component.symfony.view.wrap.class: XTAIN\Bundle\JoomlaBundle\Component\Symfony\View\WrapFactory
    joomla.factory.component.menu.view.admin_menu.class: XTAIN\Bundle\JoomlaBundle\Component\Menu\View\AdminMenuFactory
    joomla.factory.component.plugin.content.twig.class: XTAIN\Bundle\JoomlaBundle\Component\Plugin\Content\TwigFactory

    joomla.installation.installer.class: XTAIN\Bundle\JoomlaBundle\Installation\Installer
    joomla.installation.extension_installer.class: XTAIN\Bundle\JoomlaBundle\Installation\ExtensionInstaller
    joomla.loader.class: XTAIN\Bundle\JoomlaBundle\Library\Loader
    joomla.factory.class: XTAIN\Bundle\JoomlaBundle\Library\Joomla\Factory
    joomla.uri.class: XTAIN\Bundle\JoomlaBundle\Library\Joomla\Uri\Uri
    joomla.language.class: XTAIN\Bundle\JoomlaBundle\Library\Joomla\Language\Language
    joomla.event.dispatcher.class: XTAIN\Bundle\JoomlaBundle\Library\Joomla\Event\Dispatcher
    joomla.mail.class: XTAIN\Bundle\JoomlaBundle\Library\Joomla\Mail\Mail
    joomla.log.class: XTAIN\Bundle\JoomlaBundle\Library\Joomla\Log\Log
    joomla.profiler.class: XTAIN\Bundle\JoomlaBundle\Library\Joomla\Profiler\Profiler
    joomla.session.class: XTAIN\Bundle\JoomlaBundle\Library\Joomla\Session\Session
    joomla.cms.module.helper.class: XTAIN\Bundle\JoomlaBundle\Library\CMS\Module\Helper
    joomla.cms.router.site.class: XTAIN\Bundle\JoomlaBundle\Library\CMS\Router\Site
    joomla.application.base.class: XTAIN\Bundle\JoomlaBundle\Library\Joomla\Application\Base
    joomla.application.web.class: XTAIN\Bundle\JoomlaBundle\Library\Joomla\Application\Web
    joomla.cms.application.site.class: XTAIN\Bundle\JoomlaBundle\Library\CMS\Application\Site
    joomla.cms.application.administrator.class: XTAIN\Bundle\JoomlaBundle\Library\CMS\Application\Administrator
    joomla.cms.installer.installer.class: XTAIN\Bundle\JoomlaBundle\Library\CMS\Installer\Installer
    joomla.view.legacy.class: XTAIN\Bundle\JoomlaBundle\Library\View\Legacy
    joomla.document.html.class: XTAIN\Bundle\JoomlaBundle\Library\Joomla\Document\Html
    joomla.legacy.error.class: XTAIN\Bundle\JoomlaBundle\Library\Legacy\Error\Error
    joomla.router.class: XTAIN\Bundle\JoomlaBundle\Routing\JoomlaRouter
    joomla.router.default.class: XTAIN\Bundle\JoomlaBundle\Routing\DefaultRouter
    joomla.document.class: JDocument
    joomla.user.class: XTAIN\Bundle\JoomlaBundle\Library\Joomla\User\User
    joomla.config.class: XTAIN\Bundle\JoomlaBundle\Library\Config
    joomla.routing.path_matcher.class: XTAIN\Bundle\JoomlaBundle\Routing\PathMatcher
    joomla.routing.url_patcher.class: XTAIN\Bundle\JoomlaBundle\Routing\UrlPatcher
    joomla.admin.menu_manager.class: XTAIN\Bundle\JoomlaBundle\Admin\MenuManager

    joomla.security.authentication.provider.class: XTAIN\Bundle\JoomlaBundle\Security\Authentication\Provider\JoomlaAuthenticationProvider
    joomla.security.authentication.listener.class: XTAIN\Bundle\JoomlaBundle\Security\Firewall\JoomlaListener
    joomla.security.user.provider.class: XTAIN\Bundle\JoomlaBundle\Security\User\JoomlaUserProvider

    joomla.component.module.module_manager.class: XTAIN\Bundle\JoomlaBundle\Component\Module\ModuleManager

    joomla.prefix_subscriber.class: XTAIN\Bundle\JoomlaBundle\Joomla\PrefixSubscriber
    joomla.resource_locator.class: XTAIN\Bundle\JoomlaBundle\Joomla\ResourceLocator

    joomla.menu_repository.class: XTAIN\Bundle\JoomlaBundle\Entity\MenuRepository
    joomla.extension_repository.class: XTAIN\Bundle\JoomlaBundle\Entity\ExtensionRepository
    joomla.module_repository.class: XTAIN\Bundle\JoomlaBundle\Entity\ModuleRepository

    joomla.cache_key: "joomla"
    joomla.root_dir: ~
    joomla.config_dir: "%kernel.root_dir%/config"
    joomla.cache_dir: "%kernel.cache_dir%/%joomla.cache_key%/cache"
    joomla.override_dir: "%kernel.cache_dir%/%joomla.cache_key%/override"
    joomla.tmp_dir: "%kernel.cache_dir%/%joomla.cache_key%/tmp"

services:
    joomla:
        class: %joomla.class%
        calls:
            - [ setContainer, [ @service_container ] ]
            - [ setFilesystem, [ @filesystem ] ]
            - [ setRootDir, [ %joomla.root_dir% ] ]

    joomla.helper:
        class: %joomla.helper.class%
        calls:
            - [ setJoomla, [ @joomla ] ]
            - [ setTwigEnvironment, [ @twig ] ]

    joomla.controller:
        class: %joomla.controller.class%
        scope: request
        calls:
            - [ setJoomla, [ @joomla ] ]
            - [ setRequest, [ @request ] ]
            - [ setContainer, [ @service_container ] ]

    joomla.warmer.patcher:
        class: %joomla.warmer.patcher.class%
        arguments: [ %joomla.root_dir%, %joomla.cache_dir%, %joomla.override_dir% ]
        tags:
            - { name: kernel.cache_warmer }

    joomla.locale_listener:
        class: %joomla.locale_listener.class%
        calls:
            - [ setJoomla, [ @joomla ] ]
        tags:
            - { name: kernel.event_listener, event: kernel.request, method: onKernelRequest, priority: 0 }

    joomla.request_listener:
        class: %joomla.request_listener.class%
        calls:
            - [ setJoomla, [ @joomla ] ]
        tags:
            - { name: kernel.event_listener, event: kernel.request, method: onKernelRequest, priority: 31 }

    joomla.response_listener:
        class: %joomla.response_listener.class%
        calls:
            - [ setJoomla, [ @joomla ] ]
            - [ setWrapFactory, [ @joomla.factory.component.symfony.view.wrap ] ]
            - [ setPathMatcher, [ @joomla.routing.path_matcher ] ]
        tags:
            - { name: kernel.event_listener, event: kernel.response, method: onKernelResponse, priority: 0 }

    joomla.twig.module:
        class: %joomla.twig.module.class%
        calls:
            - [ setJoomla, [ @joomla ] ]
            - [ setJoomlaHelper, [ @joomla.helper ] ]
        tags:
            - { name: twig.extension }

    joomla.routing.path_matcher:
        class: %joomla.routing.path_matcher.class%
        arguments: [ @router, @joomla.menu_repository ]

    joomla.routing.url_patcher:
        class: %joomla.routing.url_patcher.class%
        arguments: [ @joomla.menu_repository ]

    joomla.router:
        class: %joomla.router.class%
        public: false
        arguments: [ @joomla.menu_repository ]
        calls:
            - [ setContext, [ @router.request_context ] ]
            - [ setLogger, [ @logger ] ]
            - [ setUrlPatcher, [ @joomla.routing.url_patcher ]]

    joomla.router.default:
        class: %joomla.router.default.class%
        parent: router.default
        tags:
            - { name: joomla.router, priority: 0 }
            - { name: monolog.logger }

    joomla.logger_proxy:
        class: %joomla.logger_proxy.class%
        calls:
            - [ setLogger, [ @logger ] ]
        tags:
            - { name: monolog.logger }

    joomla.admin.menu_manager:
        class: %joomla.admin.menu_manager.class%
        arguments: []

    # Joomla Class Factories

    joomla.factory.debug.error_handler:
        class: %joomla.factory.debug.error_handler.class%
        arguments:
            - "@logger"
            - "%joomla.root_dir%"
        tags:
          - { name: joomla.injector, class: XTAIN\Bundle\JoomlaBundle\Debug\ErrorHandler }
          - { name: monolog.logger, channel: joomla }

    joomla.factory.loader:
        class: %joomla.factory.loader.class%
        calls:
            - [ setOverrideDir, [ %joomla.override_dir% ] ]
            - [ setKernel, [ @kernel ] ]

    joomla.factory.config:
        class: %joomla.factory.config.class%
        arguments: [ %kernel.secret%, %joomla.tmp_dir%, %kernel.debug% ]
        calls:
            - [ setKernel, [ @kernel ] ]
        tags:
          - { name: joomla.injector, class: XTAIN\Bundle\JoomlaBundle\Library\Config }

    joomla.factory.factory:
        class: %joomla.factory.factory.class%
        calls:
            - [ setContainer, [ @service_container ] ]

    joomla.factory.uri:
        class: %joomla.factory.uri.class%
        calls:
            - [ setRouter, [ @router ] ]

    joomla.factory.profiler:
        class: %joomla.factory.profiler.class%
        calls:
            - [ setContainer, [ @service_container ] ]

    joomla.factory.mail:
        class: %joomla.factory.mail.class%
        calls:
            - [ setMailer, [ @mailer ] ]

    joomla.factory.log:
        class: %joomla.factory.log.class%
        calls:
            - [ setLoggerProxy, [ @joomla.logger_proxy ] ]

    joomla.factory.session:
        class: %joomla.factory.session.class%
        calls:
            - [ setSession, [ @session ] ]

    joomla.factory.event.dispatcher:
        class: %joomla.factory.event.dispatcher.class%
        calls:
            - [ setEventDispatcher, [ @event_dispatcher ] ]
            - [ setContainer, [ @service_container ] ]

    joomla.factory.application.base:
        class: %joomla.factory.application.base.class%
        calls:
            - [ setContainer, [ @service_container ] ]

    joomla.factory.application.web:
        class: %joomla.factory.application.web.class%
        calls:
            - [ setConfig, [ @joomla.config ] ]

    joomla.factory.cms.module.helper:
        class: %joomla.factory.cms.module.helper.class%
        calls:
            - [ setFileLocator, [ @file_locator ] ]
            - [ setEventDispatcher, [ @event_dispatcher ] ]

    joomla.factory.cms.router.site:
        class: %joomla.factory.cms.router.site.class%
        calls:
            - [ setMenuRepository, [ @joomla.menu_repository ] ]

    joomla.factory.cms.application.site:
        class: %joomla.factory.cms.application.site.class%

    joomla.factory.cms.application.administrator:
        class: %joomla.factory.cms.application.administrator.class%

    joomla.factory.cms.installer.installer:
        class: %joomla.factory.cms.installer.installer.class%
        calls:
            - [ setResourceLocator, [ @joomla.resource_locator ] ]
            - [ setAssetInstaller, [ @joomla.installation.asset ] ]

    joomla.factory.view.legacy:
        class: %joomla.factory.view.legacy.class%
        calls:
            - [ setTwigEnvironment, [ @twig ] ]

    joomla.factory.document.html:
        scope: request
        class: %joomla.factory.document.html.class%
        calls:
            - [ setAssetsHelper, [ @templating.helper.assets ] ]
            - [ setRouter, [ @router ] ]
            - [ setTwigEnvironment, [ @twig ] ]

    joomla.factory.legacy.error:
        class: %joomla.factory.legacy.error.class%

    joomla.factory.database.driver.doctrine:
        class: %joomla.factory.database.driver.doctrine.class%
        calls:
            - [ setEntityManager, [ @joomla.orm.entity_manager ] ]

    joomla.factory.user:
        class: %joomla.factory.user.class%

    joomla.factory.component.symfony.field.route:
        class: %joomla.factory.component.symfony.field.route.class%
        calls:
            - [ setRouter, [ @router ] ]
        tags:
          - { name: joomla.injector, class: XTAIN\Bundle\JoomlaBundle\Component\Field\Route }

    joomla.factory.component.symfony.field.symfony_modules:
        class: %joomla.factory.component.symfony.field.symfony_modules.class%
        calls:
            - [ setModuleManager, [ @joomla.component.module.module_manager ] ]
        tags:
          - { name: joomla.injector, class: XTAIN\Bundle\JoomlaBundle\Component\Field\SymfonyModules }

    joomla.factory.component.symfony.field.symfony_settings:
        class: %joomla.factory.component.symfony.field.symfony_settings.class%
        calls:
            - [ setModuleManager, [ @joomla.component.module.module_manager ] ]
            - [ setModuleRepository, [ @joomla.module_repository ] ]
        tags:
          - { name: joomla.injector, class: XTAIN\Bundle\JoomlaBundle\Component\Field\SymfonySettings }

    joomla.factory.component.symfony.view.symfony:
        class: %joomla.factory.component.symfony.view.symfony.class%
        calls:
            - [ setRouter, [ @router ] ]
            - [ setRequestStack, [ @request_stack ] ]
            - [ setKernel, [ @http_kernel ] ]
        tags:
          - { name: joomla.injector, class: SymfonyViewSymfony }

    joomla.factory.component.symfony.view.wrap:
        class: %joomla.factory.component.symfony.view.wrap.class%
        tags:
          - { name: joomla.injector, class: SymfonyViewWrap }

    joomla.factory.component.menu.view.admin_menu:
        class: %joomla.factory.component.menu.view.admin_menu.class%
        calls:
            - [ setRouter, [ @router ] ]
            - [ setAdminMenuManager, [ @joomla.admin.menu_manager ] ]
        tags:
          - { name: joomla.injector, class: XTAIN\Bundle\JoomlaBundle\Component\Menu\View\AdminMenu }

    joomla.factory.component.plugin.content.twig:
        class: %joomla.factory.component.plugin.content.twig.class%
        calls:
            - [ setTwig, [ @twig ] ]
        tags:
          - { name: joomla.injector, class: XTAIN\Bundle\JoomlaBundle\Component\Plugin\Content\Twig }

    # Joomla Services

    joomla.loader:
        class: %joomla.loader.class%
        factory: [@joomla.factory.loader, getInstance]

    joomla.factory:
        class: %joomla.factory.class%
        tags:
          - { name: joomla.service, factory: joomla.factory.factory, class: JFactory, file: "libraries/joomla/factory.php", static: static }

    joomla.uri:
        class: %joomla.uri.class%
        tags:
          - { name: joomla.service, factory: joomla.factory.uri, class: JUri, file: "libraries/joomla/uri/uri.php" }

    joomla.language:
        class: %joomla.language.class%
        tags:
          - { name: joomla.service, class: JLanguage, file: "libraries/joomla/language/language.php" }

    joomla.profiler:
        class: %joomla.profiler.class%
        factory: [@joomla.factory.profiler, getInstance]
        tags:
          - { name: joomla.service, class: JProfiler, file: "libraries/joomla/profiler/profiler.php" }

    joomla.mail:
        class: %joomla.mail.class%
        tags:
          - { name: joomla.service, class: JMail, factory: joomla.factory.mail, file: "libraries/joomla/mail/mail.php" }

    joomla.log:
        class: %joomla.log.class%
        factory: [@joomla.factory.log, getInstance]
        tags:
          - { name: joomla.service, class: JLog, file: "libraries/joomla/log/log.php" }

    joomla.session:
        class: %joomla.session.class%
        tags:
          - { name: joomla.service, static: static, factory: joomla.factory.session, class: JSession, file: "libraries/joomla/session/session.php" }

    joomla.cms.module.helper:
        class: %joomla.cms.module.helper.class%
        abstract: true
        tags:
          - { name: joomla.service, static: static, factory: joomla.factory.cms.module.helper, class: JModuleHelper, file: "libraries/cms/module/helper.php" }

    joomla.cms.router.site:
        class: %joomla.cms.router.site.class%
        factory: [@joomla.factory.cms.router.site, getInstance]
        tags:
          - { name: joomla.service, class: JRouterSite, file: "libraries/cms/router/site.php" }

    joomla.event.dispatcher:
        class: %joomla.event.dispatcher.class%
        tags:
          - { name: joomla.service, factory: joomla.factory.event.dispatcher, class: JEventDispatcher, file: "libraries/joomla/event/dispatcher.php" }

    joomla.application.base:
        abstract: true
        class: %joomla.application.base.class%
        tags:
          - { name: joomla.service, factory: joomla.factory.application.base, class: JApplicationBase, file: "libraries/joomla/application/base.php" }

    joomla.application.web:
        abstract: true
        class: %joomla.application.web.class%
        tags:
          - { name: joomla.service, factory: joomla.factory.application.web, class: JApplicationWeb, file: "libraries/joomla/application/web.php" }

    joomla.cms.application.site:
        class: %joomla.cms.application.site.class%
        factory: [@joomla.factory.cms.application.site, getInstance]
        tags:
          - { name: joomla.service, class: JApplicationSite, file: "libraries/cms/application/site.php" }

    joomla.cms.application.administrator:
        class: %joomla.cms.application.administrator.class%
        factory: [@joomla.factory.cms.application.administrator, getInstance]
        tags:
          - { name: joomla.service, class: JApplicationAdministrator, file: "libraries/cms/application/administrator.php" }

    joomla.cms.installer.installer:
        class: %joomla.cms.installer.installer.class%
        tags:
          - { name: joomla.service, factory: joomla.factory.cms.installer.installer, class: JInstaller, file: "libraries/cms/installer/installer.php" }

    joomla.view.legacy:
        abstract: true
        class: %joomla.view.legacy.class%
        tags:
         - { name: joomla.service, factory: joomla.factory.view.legacy, class: JViewLegacy, file: "libraries/legacy/view/legacy.php" }

    joomla.document.html:
        abstract: true
        class: %joomla.document.html.class%
        tags:
         - { name: joomla.service, factory: joomla.factory.document.html, class: JDocumentHtml, file: "libraries/joomla/document/html.php" }

    joomla.user:
        class: %joomla.user.class%
        tags:
         - { name: joomla.service, factory: joomla.factory.user, class: JUser, file: "libraries/joomla/user/user.php" }

    joomla.legacy.error:
        abstract: true
        class: %joomla.legacy.error.class%
        factory_service: joomla.factory.legacy.error
        tags:
          - { name: joomla.service, static: static, class: JError, file: "libraries/legacy/error/error.php" }

    joomla.database.driver.doctrine:
        class: XTAIN\Bundle\JoomlaBundle\Library\Joomla\Database\Driver\AbstractDoctrineDriver
        factory_service: joomla.factory.database.driver.doctrine
        factory_method: getInstance

    joomla.database.driver.mysql_doctrine:
        class: XTAIN\Bundle\JoomlaBundle\Library\Joomla\Database\Driver\MysqlDoctrineDriver
        tags:
          - { name: joomla.database }

    joomla.database.driver.sqlite_doctrine:
        class: XTAIN\Bundle\JoomlaBundle\Library\Joomla\Database\Driver\SqliteDoctrineDriver
        tags:
          - { name: joomla.database }

    joomla.document:
        class: %joomla.document.class%
        factory: [@joomla, getDocument]

    joomla.config:
        class: %joomla.config.class%
        factory: [@joomla.factory.config, getConfig]

    # Doctrine

    joomla.prefix_subscriber:
        class: %joomla.prefix_subscriber.class%
        arguments: [ @joomla.config ]
        tags:
            - { name: doctrine.event_subscriber }

    # Joomla Installation

    joomla.installation.extension_installer:
        class: %joomla.installation.extension_installer.class%
        arguments: [ @joomla.orm.entity_manager, @joomla.extension_repository ]

    joomla.installation.installer:
        class: %joomla.installation.installer.class%
        arguments: [ @joomla, @joomla.config ]

    joomla.installation.asset:
        class: %joomla.installation.asset.class%
        arguments: [ @kernel ]

    joomla.resource_locator:
        class: %joomla.resource_locator.class%
        arguments: [ @kernel ]

    # Joomla Security

    joomla.security.authentication.provider:
        class:     %joomla.security.authentication.provider.class%
        arguments: [ @security.user_checker, "%anonymous_key%" ]

    joomla.security.authentication.listener:
        class:     %joomla.security.authentication.listener.class%
        arguments: [ @security.context, @security.authentication.manager, "%anonymous_key%", @joomla ]

    joomla.security.user.provider:
        class: %joomla.security.user.provider.class%

    # Joomla Component

    joomla.component.module.abstract_module:
        abstract: true
        calls:
            - [ setFormFactory, [ @form.factory ] ]
            - [ setTwigEnvironment, [ @twig ] ]

    joomla.component.module.module_manager:
        class: %joomla.component.module.module_manager.class%
        calls:
            - [ setContainer, [ @service_container ] ]

    joomla.admin.default_menu:
        class: XTAIN\Bundle\JoomlaBundle\Admin\DefaultMenu
        arguments:
          - "@router"
        tags:
          - { name: joomla.admin_menu }

    # Joomla Repositories

    joomla.orm.entity_manager:
        alias: doctrine.orm.default_entity_manager

    joomla.menu_repository:
        class: %joomla.menu_repository.class%
        factory: [@joomla.orm.entity_manager, getRepository]
        arguments:
            - XTAINJoomlaBundle:Menu

    joomla.extension_repository:
        class: %joomla.extension_repository.class%
        factory: [@joomla.orm.entity_manager, getRepository]
        arguments:
            - XTAINJoomlaBundle:Extension

    joomla.module_repository:
        class: %joomla.module_repository.class%
        factory: [@joomla.orm.entity_manager, getRepository]
        arguments:
            - XTAINJoomlaBundle:Module

